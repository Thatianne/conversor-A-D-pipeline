* C:\users\thatiannecarvalho\My Documents\Faculdade\9ºSemestre\MI - PDS\pbl3\circuit.asc
V1 N004 0 SINE(5 5 100) AC 1
V4 N001 0 PULSE(0 10 0 0 0 0.07m 0.25m) AC 1
XX1 N001 N004 N003 sh
XX2 N003 N002 N005 flash2bits
XX3 N002 N005 Vout dacr2r

* block symbol definitions
.subckt sh Clock Vin Vout
C1 N002 0 10p
XU1 Vin N003 N004 N001 N003 LT1001
XU2 N002 Vout N004 N001 Vout LT1001
V2 N001 0 -12
V3 N004 0 12
M1 N003 Clock N002 N002 NMOS
.ends sh

.subckt flash2bits Vin A B
XX1 Vin N001 N002 N003 4bitscomparator
XX2 N001 N002 N003 A B 3dec2bits
.ends flash2bits

.subckt dacr2r A B Vout
R1 N001 N005 10k
R2 N002 NC_01 10k
R3 N002 N001 5k
R4 0 N002 5k
V1 N007 0 -12
V2 N004 0 12
XU1 0 N003 N004 N007 Vout level.2 Avol=1Meg GBW=10Meg Slew=10Meg ilimit=25m rail=0 Vos=0 phimargin=45 en=0 enk=0 in=0 ink=0 Rin=500Meg
V3 N001 0 5
R5 Vout N003 5k
V4 A 0 1
V5 N006 0 0
S1 N005 NC_02 NC_03 NC_04 SW
S2 NC_05 NC_06 NC_07 NC_08 SW
.model SW SW()
.ends dacr2r

.subckt 4bitscomparator Vin 1 2 3
R4 N001 N003 1k
V5 N001 0 5
R5 N003 N006 1k
R6 N006 N008 1k
V7 N004 0 5
R2 N008 0 1k
A1 0 0 0 0 N002 0 3 0 XOR
A2 0 0 0 N002 N005 0 2 0 XOR
A3 0 0 0 N005 N007 0 1 0 XOR
V1 Vin 0 SINE(2.5 2.5 100)
XU1 Vin N003 N004 0 N002 LT1017
XU2 Vin N006 N004 0 N005 LT1017
XU3 Vin N008 N004 0 N007 LT1017
.ends 4bitscomparator

.subckt 3dec2bits 1 2 3 A B
A1 0 0 3 2 0 0 A 0 OR
A2 0 3 1 0 0 0 B 0 OR
.ends 3dec2bits

.model NMOS NMOS
.model PMOS PMOS
.lib C:\users\thatiannecarvalho\My Documents\LTspiceXVII\lib\cmp\standard.mos
.tran 10ms
.lib LTC.lib
.lib LTC1.lib
.lib UniversalOpamps2.sub
.backanno
.end
